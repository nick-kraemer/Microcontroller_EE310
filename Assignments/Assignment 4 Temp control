
// Title: Heating and cooling system
//-----------------------------
// Purpose: This program takes input refrence temperature and compares it to an input measured temperature.
//	    The values of the reference temp is placed into Reg 0x60,0x61,0x62
//	    The values of the measured temp is placed into Reg 0x70,0x71,0x72
//	    If the temp is to hot a cooling system is turned on. If the temp is too cold a heating system is turned on
// Dependencies:I'am using a file called Header.inc attacted to this project.
// Compiler: ASM 2.4
// Author: Nick Kraemer
// OUTPUTS: outputs of this program? What are they connected to? 
// INPUTS: inputs of this program? What are they connected to? 
// Versions:
//  	V1.0: today’s date - First version 
//  	V1.2: date - Changes something….
//-----------------------------
; Initialization
;---------------------
#include "C:\Users\nkrae\OneDrive\Documents\310 MPlab Assignments\Assignment 4.X\Header.inc.inc"
#include <xc.inc>
    
    
// PROGRAM INPUTS
//----------------
#define  measuredTempInput 	60 ; this is the input value
#define  refTempInput 		10 ; this is the input value

//----------------
//REGISTERS
//----------------
#define  measuredTempREG 	0x21 ; this is Reg where measured temp is stored
#define  refTempREG 		0x20 ; this is Reg where RefTemp is stored
#define  contREG		0x22; This is REG where the contREG is stored
#define  maximumTEMP		0x10; this reg will help me determine if Measured temp is negative

//----------------
// PROGRAM OUTPUTS
//----------------
;#define  measuredTempDecimal 	0x70 
;#define  refTempInputDecimal      
#define   HEATER  PORTD,2
#define   COOLER  PORTD,1


;-----------MAIN CODE------------------
    PSECT absdata,abs,ovrld        ; Do not change
    ORG 0x20	;start program memory at 0x20
    MOVLW 0x00
    MOVWF	TRISD	; make PORTD an output
    MOVLW   measuredTempInput
    MOVWF   measuredTempREG ; put measure temp into measured temp Reg
    MOVLW   refTempInput
    MOVWF   refTempREG  ; put reference temp into reference temp REG


     
    ;MOVLW 0x00
    ;MOVWF STATUS
    MOVLW 0x51
    MOVWF maximumTEMP
    MOVLW measuredTempInput
    CPFSLT  maximumTEMP; if maximum temp < measured temp skip
    GOTO _EQUAL
    GOTO _LED_HEAT
	
_EQUAL:    
    MOVLW   measuredTempInput
    CPFSEQ  refTempREG ;if reference temp = measured temp skip
    GOTO _HEAT
    GOTO _LED_OFF	
	
_HEAT: 
    MOVLW   measuredTempInput
    CPFSGT  refTempREG ; if reference temp > measured temp skip (too cold)
    GOTO _COOL
    GOTO _LED_HEAT
    
_COOL:	
    MOVLW   measuredTempInput
    CPFSLT	refTempREG ; compare reference temp with measured temp if < skip (too hot)
    sleep ; if the code made it here there is an error
    GOTO _LED_COOL
	
_LED_OFF: 
    MOVLW 0x00
    MOVWF contREG	;set contreg=0
    MOVWF PORTD,a
    sleep

_LED_HEAT:
    MOVLW 0x1
    MOVWF contREG 	;set contreg=1
    MOVLW 0b00000001
    MOVWF PORTD ,a
    sleep

_LED_COOL: 
    MOVLW 0x2
    MOVWF contREG 	;set contreg=2
    MOVLW 0b00000010
    MOVWF PORTD,a
    sleep
